<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShreeLipi Final Converter V3</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <style>
        body { font-family: -apple-system, sans-serif; background: #e9eff5; text-align: center; padding: 20px; }
        .card { background: white; max-width: 550px; margin: 40px auto; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
        h2 { color: #222; margin-bottom: 5px; }
        p { color: #666; font-size: 14px; margin-bottom: 25px; }
        
        .upload-area {
            border: 2px dashed #007aff; background: #f0f8ff; color: #007aff;
            padding: 40px; border-radius: 12px; font-weight: 600; cursor: pointer;
            margin-bottom: 20px; display: block; transition: 0.3s;
        }
        .upload-area:hover { background: #e0f0ff; }
        input[type="file"] { display: none; }

        button {
            background: #007aff; color: white; border: none; padding: 15px; width: 100%;
            border-radius: 10px; font-size: 18px; font-weight: 600; cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,122,255,0.3);
        }
        button:disabled { background: #ccc; cursor: not-allowed; box-shadow: none; }
        
        #status { margin-top: 20px; font-size: 15px; font-weight: 500; color: #333; }
        #fileName { margin-bottom: 15px; color: #555; font-size: 14px; }
    </style>
</head>
<body>

    <div class="card">
        <h2>Word to Word (Final Fix)</h2>
        <p>Corrects {‡§µ‡§ö‡§æ‡§∞, $ signs, and missing characters.</p>

        <label for="fileInput" class="upload-area">
            üìÇ Tap to Select Word File
        </label>
        <input type="file" id="fileInput" accept=".docx,application/vnd.openxmlformats-officedocument.wordprocessingml.document">
        
        <div id="fileName"></div>
        <button id="convertBtn" disabled>Convert Now</button>
        <div id="status"></div>
    </div>

    <script>
        // --- 1. MAPPING ARRAYS ---
        const saral_list = ["n_R.e", "r_R.e", ";_R.e", "n_IR.", "r_IR.", ";_IR.", "kR.e", "qR.e", "gR.e", "6R.e", "∆íR.e", "cR.e", "7R.e", "jR.e", "zR.e", "‚ÄòR.e", "3R.e", "#R.e", "DR.e", "!R.e", "`R.e", "tR.e", "4R.e", "dR.e", "2R.e", "nR.e", "pR.e", "fR.e", "bR.e", "wR.e", "mR.e", "yR.e", "rR.e", "lR.e", "vR.e", "xR.e", "8R.e", "sR.e", "hR.e", ";R.e", "9R.e", ")R.e", "n_R.", "r_R.", ";_R.", "n_IR", "r_IR", ";_IR", "kIR.", "qIR.", "gIR.", "6IR.", "∆íIR.", "cIR.", "7IR.", "jIR.", "zIR.", "‚ÄòIR.", "3IR.", "#IR.", "DIR.", "!IR.", "`IR.", "tIR.", "4IR.", "dIR.", "2IR.", "nIR.", "pIR.", "fIR.", "bIR.", "wIR.", "mIR.", "yIR.", "rIR.", "lIR.", "vIR.", "xIR.", "8IR.", "sIR.", "hIR.", ";IR.", "9IR.", ")IR.", "n_aR", "r_aR", ";_aR", "in_R", "ir_R", "i;_R", "Aa≈°", "kR.", "qR.", "gR.", "6R.", "∆íR.", "cR.", "7R.", "jR.", "zR.", "‚ÄòR.", "3R.", "#R.", "DR.", "!R.", "`R.", "tR.", "4R.", "dR.", "2R.", "nR.", "pR.", "fR.", "bR.", "wR.", "mR.", "yR.", "rR.", "lR.", "vR.", "xR.", "8R.", "sR.", "hR.", ";R.", "9R.", ")R.", "kIR", "qIR", "gIR", "6IR", "∆íIR", "cIR", "7IR", "jIR", "zIR", "‚ÄòIR", "3IR", "#IR", "DIR", "!IR", "`IR", "tIR", "4IR", "dIR", "2IR", "nIR", "pIR", "fIR", "bIR", "wIR", "mIR", "yIR", "rIR", "lIR", "vIR", "xIR", "8IR", "sIR", "hIR", ";IR", "9IR", ")IR", "n_R", "r_R", ";_R", "n_/", ";_/", ";_\\", "kaR", "qaR", "gaR", "6aR", "∆íaR", "caR", "7aR", "jaR", "zaR", "‚ÄòaR", "3aR", "#aR", "DaR", "!aR", "`aR", "taR", "4aR", "daR", "2aR", "naR", "paR", "faR", "baR", "waR", "maR", "yaR", "raR", "laR", "vaR", "xaR", "8aR", "saR", "haR", ";aR", "9aR", ")aR", "ikR", "iqR", "igR", "i6R", "i∆íR", "icR", "i7R", "ijR", "izR", "i‚ÄòR", "i3R", "i#R", "iDR", "i!R", "i`R", "itR", "i4R", "idR", "i2R", "inR", "ipR", "ifR", "ibR", "iwR", "imR", "iyR", "irR", "ilR", "ivR", "ixR", "i8R", "isR", "ihR", "i;R", "i9R", "i)R", "Aa", "0e", "1<", "l<", "A:", "n_", "r_", ";_", "a≈°", "kR", "qR", "gR", "6R", "∆íR", "cR", "7R", "jR", "zR", "‚ÄòR", "3R", "#R", "DR", "!R", "`R", "tR", "4R", "dR", "2R", "nR", "pR", "fR", "bR", "wR", "mR", "yR", "rR", "lR", "vR", "xR", "8R", "sR", "hR", ";R", "9R", ")R", "q/", "g/", "6/", "∆í/", "c/", "7/", "j/", "z/", "‚Äò/", "3/", "#/", "!/", "`/", "4/", "2/", "n/", "p/", "b/", "w/", "m/", "y/", "l/", "v/", "8/", "s/", ";/", "9/", ")/", "∆í\\", "7\\", "3\\", "#\\", "D\\", "!\\", "d\\", "N_", ";\\", "A", "[", "{", "]", "}", "0", "1", "‚Ä†", "ÀÜ", "≈†", "k", "q", "g", "6", "∆í", "c", "7", "j", "z", "‚Äò", "3", "#", "D", "!", "`", "t", "4", "d", "2", "n", "p", "f", "b", "w", "m", "y", "r", "l", "v", "x", "8", "s", "h", ";", "9", ")", "‚Ä∫", "_", "-", "|", "\\", "E", "e", "u", "U", "I", "i", "O", "o", "a", ":", "<", ",", ">", ".", "≈°", "¬æ", "¬Ω", "¬º", "¬ª", "¬π", "¬∑", "¬∂", "¬µ", "¬¥", "¬≤", "¬±", "¬Ø", "¬Æ", "¬≠", "¬¨", "¬´", "¬™", "¬©", "¬®", "¬ß", "¬¶", "¬•", "¬§", "¬£", "≈í", "Àú", "‚Äî", "‚Äú", "‚Äù", "‚Ä°", "‚Ä¶", "‚Ä∞", "‚Äπ", "+", "=", "‚Ñ¢", "√à", "√â", "√ä", "√ã", "√å", "√ç", "√é", "√è", "√ê", "√ë", "√í", "√ì", "√î", "√ï", "√ñ", "√ó", "√ò", "√ô", "√ö", "√õ", "√ú", "√ù", "√û", "√ü", "√†", "√°", "√¢", "√£", "√§", "√•", "'", "\"", "¬¢", "¬ø", "5", "¬≥", "¬∏", "&", "¬∫", "K", "Q", "G", "^", "C", "J", "Z", "‚Äô", "~", "T", "$", "@", "N", "P", "F", "B", "W", "M", "Y", "‚Äì", "L", "V", "X", "*", "S", "H", "(", "‚Ä¢"];
const unicode_list = ["‡§∞‡•ç‡§©‡•á‡§Ç", "‡§∞‡•ç‡§±‡•á‡§Ç", "‡§∞‡•ç‡§¥‡•á‡§Ç", "‡§∞‡•ç‡§©‡•Ä‡§Ç", "‡§∞‡•ç‡§±‡•Ä‡§Ç", "‡§∞‡•ç‡§¥‡•Ä‡§Ç", "‡§∞‡•ç‡§ï‡•á‡§Ç", "‡§∞‡•ç‡§ñ‡•á‡§Ç", "‡§∞‡•ç‡§ó‡•á‡§Ç", "‡§∞‡•ç‡§ò‡•á‡§Ç", "‡§∞‡•ç‡§ô‡•á‡§Ç", "‡§∞‡•ç‡§ö‡•á‡§Ç", "‡§∞‡•ç‡§õ‡•á‡§Ç", "‡§∞‡•ç‡§ú‡•á‡§Ç", "‡§∞‡•ç‡§ù‡•á‡§Ç", "‡§∞‡•ç‡§û‡•á‡§Ç", "‡§∞‡•ç‡§ü‡•á‡§Ç", "‡§∞‡•ç‡§†‡•á‡§Ç", "‡§∞‡•ç‡§°‡•á‡§Ç", "‡§∞‡•ç‡§¢‡•á‡§Ç", "‡§∞‡•ç‡§£‡•á‡§Ç", "‡§∞‡•ç‡§§‡•á‡§Ç", "‡§∞‡•ç‡§•‡•á‡§Ç", "‡§∞‡•ç‡§¶‡•á‡§Ç", "‡§∞‡•ç‡§ß‡•á‡§Ç", "‡§∞‡•ç‡§®‡•á‡§Ç", "‡§∞‡•ç‡§™‡•á‡§Ç", "‡§∞‡•ç‡§´‡•á‡§Ç", "‡§∞‡•ç‡§¨‡•á‡§Ç", "‡§∞‡•ç‡§≠‡•á‡§Ç", "‡§∞‡•ç‡§Æ‡•á‡§Ç", "‡§∞‡•ç‡§Ø‡•á‡§Ç", "‡§∞‡•ç‡§∞‡•á‡§Ç", "‡§∞‡•ç‡§≤‡•á‡§Ç", "‡§∞‡•ç‡§µ‡•á‡§Ç", "‡§∞‡•ç‡§∂‡•á‡§Ç", "‡§∞‡•ç‡§∑‡•á‡§Ç", "‡§∞‡•ç‡§∏‡•á‡§Ç", "‡§∞‡•ç‡§π‡•á‡§Ç", "‡§∞‡•ç‡§≥‡•á‡§Ç", "‡§∞‡•ç‡§ï‡•ç‡§∑‡•á‡§Ç", "‡§∞‡•ç‡§ú‡•ç‡§û‡•á‡§Ç", "‡§∞‡•ç‡§©‡§Ç", "‡§∞‡•ç‡§±‡§Ç", "‡§∞‡•ç‡§¥‡§Ç", "‡§∞‡•ç‡§©‡•Ä", "‡§∞‡•ç‡§±‡•Ä", "‡§∞‡•ç‡§¥‡•Ä", "‡§∞‡•ç‡§ï‡•Ä‡§Ç", "‡§∞‡•ç‡§ñ‡•Ä‡§Ç", "‡§∞‡•ç‡§ó‡•Ä‡§Ç", "‡§∞‡•ç‡§ò‡•Ä‡§Ç", "‡§∞‡•ç‡§ô‡•Ä‡§Ç", "‡§∞‡•ç‡§ö‡•Ä‡§Ç", "‡§∞‡•ç‡§õ‡•Ä‡§Ç", "‡§∞‡•ç‡§ú‡•Ä‡§Ç", "‡§∞‡•ç‡§ù‡•Ä‡§Ç", "‡§∞‡•ç‡§û‡•Ä‡§Ç", "‡§∞‡•ç‡§ü‡•Ä‡§Ç", "‡§∞‡•ç‡§†‡•Ä‡§Ç", "‡§∞‡•ç‡§°‡•Ä‡§Ç", "‡§∞‡•ç‡§¢‡•Ä‡§Ç", "‡§∞‡•ç‡§£‡•Ä‡§Ç", "‡§∞‡•ç‡§§‡•Ä‡§Ç", "‡§∞‡•ç‡§•‡•Ä‡§Ç", "‡§∞‡•ç‡§¶‡•Ä‡§Ç", "‡§∞‡•ç‡§ß‡•Ä‡§Ç", "‡§∞‡•ç‡§®‡•Ä‡§Ç", "‡§∞‡•ç‡§™‡•Ä‡§Ç", "‡§∞‡•ç‡§´‡•Ä‡§Ç", "‡§∞‡•ç‡§¨‡•Ä‡§Ç", "‡§∞‡•ç‡§≠‡•Ä‡§Ç", "‡§∞‡•ç‡§Æ‡•Ä‡§Ç", "‡§∞‡•ç‡§Ø‡•Ä‡§Ç", "‡§∞‡•ç‡§∞‡•Ä‡§Ç", "‡§∞‡•ç‡§≤‡•Ä‡§Ç", "‡§∞‡•ç‡§µ‡•Ä‡§Ç", "‡§∞‡•ç‡§∂‡•Ä‡§Ç", "‡§∞‡•ç‡§∑‡•Ä‡§Ç", "‡§∞‡•ç‡§∏‡•Ä‡§Ç", "‡§∞‡•ç‡§π‡•Ä‡§Ç", "‡§∞‡•ç‡§≥‡•Ä‡§Ç", "‡§∞‡•ç‡§ï‡•ç‡§∑‡•Ä‡§Ç", "‡§∞‡•ç‡§ú‡•ç‡§û‡•Ä‡§Ç", "‡§∞‡•ç‡§©‡§æ", "‡§∞‡•ç‡§±‡§æ", "‡§∞‡•ç‡§¥‡§æ", "‡§∞‡•ç‡§©‡§ø", "‡§∞‡•ç‡§±‡§ø", "‡§∞‡•ç‡§¥‡§ø", "‡§ë", "‡§∞‡•ç‡§ï‡§Ç", "‡§∞‡•ç‡§ñ‡§Ç", "‡§∞‡•ç‡§ó‡§Ç", "‡§∞‡•ç‡§ò‡§Ç", "‡§∞‡•ç‡§ô‡§Ç", "‡§∞‡•ç‡§ö‡§Ç", "‡§∞‡•ç‡§õ‡§Ç", "‡§∞‡•ç‡§ú‡§Ç", "‡§∞‡•ç‡§ù‡§Ç", "‡§∞‡•ç‡§û‡§Ç", "‡§∞‡•ç‡§ü‡§Ç", "‡§∞‡•ç‡§†‡§Ç", "‡§∞‡•ç‡§°‡§Ç", "‡§∞‡•ç‡§¢‡§Ç", "‡§∞‡•ç‡§£‡§Ç", "‡§∞‡•ç‡§§‡§Ç", "‡§∞‡•ç‡§•‡§Ç", "‡§∞‡•ç‡§¶‡§Ç", "‡§∞‡•ç‡§ß‡§Ç", "‡§∞‡•ç‡§®‡§Ç", "‡§∞‡•ç‡§™‡§Ç", "‡§∞‡•ç‡§´‡§Ç", "‡§∞‡•ç‡§¨‡§Ç", "‡§∞‡•ç‡§≠‡§Ç", "‡§∞‡•ç‡§Æ‡§Ç", "‡§∞‡•ç‡§Ø‡§Ç", "‡§∞‡•ç‡§∞‡§Ç", "‡§∞‡•ç‡§≤‡§Ç", "‡§∞‡•ç‡§µ‡§Ç", "‡§∞‡•ç‡§∂‡§Ç", "‡§∞‡•ç‡§∑‡§Ç", "‡§∞‡•ç‡§∏‡§Ç", "‡§∞‡•ç‡§π‡§Ç", "‡§∞‡•ç‡§≥‡§Ç", "‡§∞‡•ç‡§ï‡•ç‡§∑‡§Ç", "‡§∞‡•ç‡§ú‡•ç‡§û‡§Ç", "‡§∞‡•ç‡§ï‡•Ä", "‡§∞‡•ç‡§ñ‡•Ä", "‡§∞‡•ç‡§ó‡•Ä", "‡§∞‡•ç‡§ò‡•Ä", "‡§∞‡•ç‡§ô‡•Ä", "‡§∞‡•ç‡§ö‡•Ä", "‡§∞‡•ç‡§õ‡•Ä", "‡§∞‡•ç‡§ú‡•Ä", "‡§∞‡•ç‡§ù‡•Ä", "‡§∞‡•ç‡§û‡•Ä", "‡§∞‡•ç‡§ü‡•Ä", "‡§∞‡•ç‡§†‡•Ä", "‡§∞‡•ç‡§°‡•Ä", "‡§∞‡•ç‡§¢‡•Ä", "‡§∞‡•ç‡§£‡•Ä", "‡§∞‡•ç‡§§‡•Ä", "‡§∞‡•ç‡§•‡•Ä", "‡§∞‡•ç‡§¶‡•Ä", "‡§∞‡•ç‡§ß‡•Ä", "‡§∞‡•ç‡§®‡•Ä", "‡§∞‡•ç‡§™‡•Ä", "‡§∞‡•ç‡§´‡•Ä", "‡§∞‡•ç‡§¨‡•Ä", "‡§∞‡•ç‡§≠‡•Ä", "‡§∞‡•ç‡§Æ‡•Ä", "‡§∞‡•ç‡§Ø‡•Ä", "‡§∞‡•ç‡§∞‡•Ä", "‡§∞‡•ç‡§≤‡•Ä", "‡§∞‡•ç‡§µ‡•Ä", "‡§∞‡•ç‡§∂‡•Ä", "‡§∞‡•ç‡§∑‡•Ä", "‡§∞‡•ç‡§∏‡•Ä", "‡§∞‡•ç‡§π‡•Ä", "‡§∞‡•ç‡§≥‡•Ä", "‡§∞‡•ç‡§ï‡•ç‡§∑‡•Ä", "‡§∞‡•ç‡§ú‡•ç‡§û‡•Ä", "‡§∞‡•ç‡§©", "‡§±‡•ç‡§∞", "‡§∞‡•ç‡§¥", "‡§©‡•ç‡§∞", "‡§¥‡•ç‡§∞", "‡§¥‡•ç", "‡§∞‡•ç‡§ï‡§æ", "‡§∞‡•ç‡§ñ‡§æ", "‡§∞‡•ç‡§ó‡§æ", "‡§∞‡•ç‡§ò‡§æ", "‡§∞‡•ç‡§ô‡§æ", "‡§∞‡•ç‡§ö‡§æ", "‡§∞‡•ç‡§õ‡§æ", "‡§∞‡•ç‡§ú‡§æ", "‡§∞‡•ç‡§ù‡§æ", "‡§∞‡•ç‡§û‡§æ", "‡§∞‡•ç‡§ü‡§æ", "‡§∞‡•ç‡§†‡§æ", "‡§∞‡•ç‡§°‡§æ", "‡§∞‡•ç‡§¢‡§æ", "‡§∞‡•ç‡§£‡§æ", "‡§∞‡•ç‡§§‡§æ", "‡§∞‡•ç‡§•‡§æ", "‡§∞‡•ç‡§¶‡§æ", "‡§∞‡•ç‡§ß‡§æ", "‡§∞‡•ç‡§®‡§æ", "‡§∞‡•ç‡§™‡§æ", "‡§∞‡•ç‡§´‡§æ", "‡§∞‡•ç‡§¨‡§æ", "‡§∞‡•ç‡§≠‡§æ", "‡§∞‡•ç‡§Æ‡§æ", "‡§∞‡•ç‡§Ø‡§æ", "‡§∞‡•ç‡§∞‡§æ", "‡§∞‡•ç‡§≤‡§æ", "‡§∞‡•ç‡§µ‡§æ", "‡§∞‡•ç‡§∂‡§æ", "‡§∞‡•ç‡§∑‡§æ", "‡§∞‡•ç‡§∏‡§æ", "‡§∞‡•ç‡§π‡§æ", "‡§∞‡•ç‡§≥‡§æ", "‡§∞‡•ç‡§ï‡•ç‡§∑‡§æ", "‡§∞‡•ç‡§ú‡•ç‡§û‡§æ", "‡§∞‡•ç‡§ï‡§ø", "‡§∞‡•ç‡§ñ‡§ø", "‡§∞‡•ç‡§ó‡§ø", "‡§∞‡•ç‡§ò‡§ø", "‡§∞‡•ç‡§ô‡§ø", "‡§∞‡•ç‡§ö‡§ø", "‡§∞‡•ç‡§õ‡§ø", "‡§∞‡•ç‡§ú‡§ø", "‡§∞‡•ç‡§ù‡§ø", "‡§∞‡•ç‡§û‡§ø", "‡§∞‡•ç‡§ü‡§ø", "‡§∞‡•ç‡§†‡§ø", "‡§∞‡•ç‡§°‡§ø", "‡§∞‡•ç‡§¢‡§ø", "‡§∞‡•ç‡§£‡§ø", "‡§∞‡•ç‡§§‡§ø", "‡§∞‡•ç‡§•‡§ø", "‡§∞‡•ç‡§¶‡§ø", "‡§∞‡•ç‡§ß‡§ø", "‡§∞‡•ç‡§®‡§ø", "‡§∞‡•ç‡§™‡§ø", "‡§∞‡•ç‡§´‡§ø", "‡§∞‡•ç‡§¨‡§ø", "‡§∞‡•ç‡§≠‡§ø", "‡§∞‡•ç‡§Æ‡§ø", "‡§∞‡•ç‡§Ø‡§ø", "‡§∞‡•ç‡§∞‡§ø", "‡§∞‡•ç‡§≤‡§ø", "‡§∞‡•ç‡§µ‡§ø", "‡§∞‡•ç‡§∂‡§ø", "‡§∞‡•ç‡§∑‡§ø", "‡§∞‡•ç‡§∏‡§ø", "‡§∞‡•ç‡§π‡§ø", "‡§∞‡•ç‡§≥‡§ø", "‡§∞‡•ç‡§ï‡•ç‡§∑‡§ø", "‡§∞‡•ç‡§ú‡•ç‡§û‡§ø", "‡§Ü", "‡§ê", "‡§ã‡•É", "‡•°", "‡§Ö‡§É", "‡§©", "‡§±", "‡§¥", "‡•â", "‡§∞‡•ç‡§ï", "‡§∞‡•ç‡§ñ", "‡§∞‡•ç‡§ó", "‡§∞‡•ç‡§ò", "‡§∞‡•ç‡§ô", "‡§∞‡•ç‡§ö", "‡§∞‡•ç‡§õ", "‡§∞‡•ç‡§ú", "‡§∞‡•ç‡§ù", "‡§∞‡•ç‡§û", "‡§∞‡•ç‡§ü", "‡§∞‡•ç‡§†", "‡§∞‡•ç‡§°", "‡§∞‡•ç‡§¢", "‡§∞‡•ç‡§£", "‡§∞‡•ç‡§§", "‡§∞‡•ç‡§•", "‡§∞‡•ç‡§¶", "‡§∞‡•ç‡§ß", "‡§∞‡•ç‡§®", "‡§∞‡•ç‡§™", "‡§∞‡•ç‡§´", "‡§∞‡•ç‡§¨", "‡§∞‡•ç‡§≠", "‡§∞‡•ç‡§Æ", "‡§∞‡•ç‡§Ø", "‡§∞‡•ç‡§∞", "‡§∞‡•ç‡§≤", "‡§∞‡•ç‡§µ", "‡§∞‡•ç‡§∂", "‡§∞‡•ç‡§∑", "‡§∞‡•ç‡§∏", "‡§∞‡•ç‡§π", "‡§∞‡•ç‡§≥", "‡§∞‡•ç‡§ï‡•ç‡§∑", "‡§∞‡•ç‡§ú‡•ç‡§û", "‡§ñ‡•ç‡§∞", "‡§ó‡•ç‡§∞", "‡§ò‡•ç‡§∞", "‡§ô‡•ç‡§∞", "‡§ö‡•ç‡§∞", "‡§õ‡•ç‡§∞", "‡§ú‡•ç‡§∞", "‡§ù‡•ç‡§∞", "‡§û‡•ç‡§∞", "‡§ü‡•ç‡§∞", "‡§†‡•ç‡§∞", "‡§¢‡•ç‡§∞", "‡§£‡•ç‡§∞", "‡§•‡•ç‡§∞", "‡§ß‡•ç‡§∞", "‡§®‡•ç‡§∞", "‡§™‡•ç‡§∞", "‡§¨‡•ç‡§∞", "‡§≠‡•ç‡§∞", "‡§Æ‡•ç‡§∞", "‡§Ø‡•ç‡§∞", "‡§≤‡•ç‡§∞", "‡§µ‡•ç‡§∞", "‡§∑‡•ç‡§∞", "‡§∏‡•ç‡§∞", "‡§≥‡•ç‡§∞", "‡§ï‡•ç‡§∑‡•ç‡§∞", "‡§ú‡•ç‡§û‡•ç‡§∞", "‡§ô‡•ç", "‡§õ‡•ç", "‡§ü‡•ç", "‡§†‡•ç", "‡§°‡•ç", "‡§¢‡•ç", "‡§¶‡•ç", "‡§©‡•ç", "‡§≥‡•ç", "‡§Ö", "‡§á", "‡§à", "‡§â", "‡§ä", "‡§è", "‡§ã", "‡§ì", "‡§î", "‡§Ö‡§Ç", "‡§ï", "‡§ñ", "‡§ó", "‡§ò", "‡§ô", "‡§ö", "‡§õ", "‡§ú", "‡§ù", "‡§û", "‡§ü", "‡§†", "‡§°", "‡§¢", "‡§£", "‡§§", "‡§•", "‡§¶", "‡§ß", "‡§®", "‡§™", "‡§´", "‡§¨", "‡§≠", "‡§Æ", "‡§Ø", "‡§∞", "‡§≤", "‡§µ", "‡§∂", "‡§∑", "‡§∏", "‡§π", "‡§≥", "‡§ï‡•ç‡§∑", "‡§ú‡•ç‡§û", "‡•§", "‡§º", "-", ".", "‡•ç", "‡•à", "‡•á", "‡•Å", "‡•Ç", "‡•Ä", "‡§ø", "‡•å", "‡•ã", "‡§æ", "‡§É", "‡•É", ",", "‡§Å", "‡§Ç", "‡•Ö", "‡§π‡•ç‡§Ø", "‡§π‡•ç‡§Æ", "‡§π‡•ç‡§≤", "‡§π‡•ç‡§®", "‡§π‡•É", "‡§´‡•É", "‡§®‡•ç‡§®", "‡§¶‡•ç‡§µ", "‡§¶‡•ç‡§Ø", "‡§¶‡•ç‡§ß", "‡§¶‡•ç‡§¶", "‡§ï‡•ç‡§§", "‡§¢‡•ç‡§¢", "‡§°‡•ç‡§°", "‡§†‡•ç‡§†", "‡§ü‡•ç‡§Ø", "‡§ü‡•ç‡§†", "‡§ü‡•ç‡§ü", "‡§ü‡•ç‡§∞", "‡§ô‡•ç‡§Æ", "‡§ô‡•ç‡§ò", "‡§ô‡•ç‡§ó", "‡§ô‡•ç‡§ñ", "‡§ô‡•ç‡§ï", "‡§Ö‡§Å", "‡••", "‡•ê", "‡§¢‡§º", "‡§§‡•ç‡§∞‡•ç", "‡§§‡•ç‡§∞‡•ç‡§™‡•ç‡§∞‡•å", "‡§§‡•ç‡§∞‡•ç‡§™‡•ç‡§∞‡•ã", "‡§§‡•ç‡§∞‡•ç‡§™‡•ç‡§∞‡§Ç", "‡§§‡•ç‡§∞‡•ç‡§™‡•ç‡§∞‡§Å", "‡§∞‡•Ç", "‡§∞‡•Å", "‡§Ω", "‡•¶", "‡•ß", "‡•®", "‡•©", "‡•™", "‡•´", "‡•¨", "‡•≠", "‡•Æ", "‡•Ø", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "(", ")", "*", "+", "-", "À£", "‚àª", "/", "$", ";", "‚Äô", "‚Äú", "‡§ï‡•ç‡§∞", "‡§°‡•ç‡§∞", "‡§§‡•ç‡§∞", "‡§¶‡•ç‡§∞", "‡§´‡•ç‡§∞", "‡§∂‡•ç‡§∞", "‡§π‡•ç‡§∞", "‡§ï‡•ç", "‡§ñ‡•ç", "‡§ó‡•ç", "‡§ò‡•ç", "‡§ö‡•ç", "‡§ú‡•ç", "‡§ù‡•ç", "‡§û‡•ç", "‡§£‡•ç", "‡§§‡•ç", "‡§•‡•ç", "‡§ß‡•ç", "‡§®‡•ç", "‡§™‡•ç", "‡§´‡•ç", "‡§¨‡•ç", "‡§≠‡•ç", "‡§Æ‡•ç", "‡§Ø‡•ç", "‡§±‡•ç", "‡§≤‡•ç", "‡§µ‡•ç", "‡§∂‡•ç", "‡§∑‡•ç", "‡§∏‡•ç", "‡§π‡•ç", "‡§ï‡•ç‡§∑‡•ç", "‡§ú‡•ç‡§û‡•ç"];

        // --- 2. CONVERSION LOGIC ---
        function convertText(text) {
            if (!text) return "";
            let res = text;

            // Step A: Basic Replacement
            for (let i = 0; i < shreelipi_list.length; i++) {
                if (shreelipi_list[i] && unicode_list[i]) {
                    res = res.split(shreelipi_list[i]).join(unicode_list[i]);
                }
            }

            // Step B: FIX for '{' (Velaanti) - This was missing!
            // Example: {‡§µ‡§ö‡§æ‡§∞ -> ‡§µ‡§ø‡§ö‡§æ‡§∞
            let pos_curly = res.indexOf("{");
            while (pos_curly !== -1) {
                if (pos_curly + 1 < res.length) {
                    let next = res.charAt(pos_curly + 1);
                    if (next !== ' ') {
                        // Swap: { + char -> char + ‡§ø
                        res = res.replace("{" + next, next + "‡§ø");
                    }
                }
                pos_curly = res.indexOf("{", pos_curly + 1);
            }

            // Step C: FIX for 'o' (Velaanti)
            let pos_o = res.indexOf("o");
            while (pos_o !== -1) {
                if (pos_o + 1 < res.length) {
                    let next = res.charAt(pos_o + 1);
                    // Avoid swapping if next is space
                    if (next !== ' ' && next !== '‡•ç') {
                         res = res.replace("o" + next, next + "‡§ø");
                    }
                }
                pos_o = res.indexOf("o", pos_o + 1);
            }

            // Step D: Half Letter with Velaanti (‡§ø‡•ç -> ‡•ç...‡§ø)
            let pos_half = res.indexOf("‡§ø‡•ç");
            while (pos_half !== -1) {
                if (pos_half + 2 < res.length) {
                    let cons = res.charAt(pos_half + 2);
                    res = res.replace("‡§ø‡•ç" + cons, "‡•ç" + cons + "‡§ø");
                }
                pos_half = res.indexOf("‡§ø‡•ç", pos_half + 2);
            }

            // Step E: 'q' -> 'o' (Anuswar Logic)
            let pos_q = res.indexOf("q");
            while (pos_q !== -1) {
                if (pos_q + 1 < res.length) {
                    let next = res.charAt(pos_q + 1);
                    res = res.replace("q" + next, next + "o");
                }
                pos_q = res.indexOf("q", pos_q + 1);
            }

            // Step F: 'o' + Halant
            let pos_oh = res.indexOf("o‡•ç");
            while (pos_oh !== -1) {
                if (pos_oh + 2 < res.length) {
                    let cons = res.charAt(pos_oh + 2);
                    res = res.replace("o‡•ç" + cons, "‡•ç" + cons + "‡§ø‡§Ç");
                }
                pos_oh = res.indexOf("o‡•ç", pos_oh + 3);
            }

            // Cleanup: Any remaining 'o' becomes Anuswar
            res = res.replace(/o/g, "‡§ø‡§Ç");

            // Step G: Reph (Rafar) ¬© -> ‡§∞‡•ç
            const matras = "‡§æ‡§ø‡•Ä‡•Å‡•Ç‡•É‡•á‡•à‡•ã‡•å‡§Ç‡§É‡§Å‡•Ö";
            let pos_reph = res.indexOf("¬©");
            while (pos_reph > 0) {
                let prob = pos_reph - 1;
                while (prob >= 0 && matras.includes(res.charAt(prob))) {
                    prob--;
                }
                if (prob < 0) prob = 0;
                
                let chunk = res.substring(prob, pos_reph);
                let before = res.substring(0, prob);
                let after = res.substring(pos_reph + 1);
                
                res = before + "‡§∞‡•ç" + chunk + after;
                pos_reph = res.indexOf("¬©", prob + chunk.length + 2);
            }

            return res;
        }

        // --- 3. FILE PROCESSING ---
        const fileInput = document.getElementById('fileInput');
        const convertBtn = document.getElementById('convertBtn');
        const fileNameDiv = document.getElementById('fileName');
        const statusDiv = document.getElementById('status');

        fileInput.addEventListener('change', () => {
            if(fileInput.files.length > 0) {
                fileNameDiv.innerText = "Selected: " + fileInput.files[0].name;
                convertBtn.disabled = false;
            }
        });

        convertBtn.addEventListener('click', async () => {
            convertBtn.disabled = true;
            convertBtn.innerText = "Processing...";
            statusDiv.innerText = "";

            try {
                if (typeof JSZip === 'undefined') throw new Error("Please check internet connection.");

                const file = fileInput.files[0];
                const arrayBuffer = await file.arrayBuffer();
                const zip = await JSZip.loadAsync(arrayBuffer);
                
                // Validate
                if (!zip.file("word/document.xml")) throw new Error("Invalid Word file.");

                // Read
                const docXml = await zip.file("word/document.xml").async("string");
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(docXml, "text/xml");
                const textNodes = xmlDoc.getElementsByTagName("w:t");

                // Convert
                let count = 0;
                for (let i = 0; i < textNodes.length; i++) {
                    let original = textNodes[i].textContent;
                    if (original && original.trim().length > 0) {
                        textNodes[i].textContent = convertText(original);
                        count++;
                    }
                }

                // Write Back
                const serializer = new XMLSerializer();
                const newDocXml = serializer.serializeToString(xmlDoc);
                zip.file("word/document.xml", newDocXml);

                // Download
                const blob = await zip.generateAsync({
                    type: "blob",
                    mimeType: "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
                });

                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = "Fixed_" + file.name;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);

                convertBtn.innerText = "Done! Convert Another";
                statusDiv.innerText = "Success! File Downloaded.";
                statusDiv.style.color = "green";

            } catch (err) {
                alert("Error: " + err.message);
                statusDiv.innerText = "Error: " + err.message;
                statusDiv.style.color = "red";
                convertBtn.innerText = "Try Again";
                convertBtn.disabled = false;
            }
        });
    </script>
</body>
</html>
